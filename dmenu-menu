#!/bin/sh
# Title:    dmenu-menu
# Author:   Tom Vincent
# Created:  2009-08-05
#
# A recursive dmenu menu.
#
# Influenced by: http://crunchbanglinux.org/forums/topic/3170/recursive-dmenu/
#
# TODO:
# * Clean the dmenu display name -- see if gsub can use $WD instead

WD=$(dirname $0)
BASENAME=$(basename $0)
HIDE="$BASENAME|dmenu-path"

##
# Find the installed modules
#
findModules()
{
    find $WD -name "dmenu*" ! -name dmenu | grep -Ev "($HIDE)"
}

##
# Remove the leading "/home/tom/bin/"
#
cleanName()
{
    findModules | while read LINE; do
        echo "$LINE" | awk '{gsub (/\/home\/tom\/bin\//, ""); print}'
    done
}

##
# Main function.
#
exec $(cleanName | dmenu)
