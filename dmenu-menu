#!/bin/sh
# Title:    dmenu-menu
# Author:   Tom Vincent
# Created:  2009-08-05
#
# A recursive dmenu menu.
#
# Influenced by: http://crunchbanglinux.org/forums/topic/3170/recursive-dmenu/

WD=$(dirname $0)
BASENAME=$(basename $0)
HIDE="$BASENAME|dmenu-path"

#
# Find the installed modules
#
findModules()
{
    find $WD -maxdepth 1 -name "dmenu*" ! -name dmenu | grep -Ev "($HIDE)"
}

#
# Remove the leading directory path.
# Note: will only work if the modules are in the $WD
#
cleanName()
{
    findModules | while read LINE; do
        echo "$LINE" | sed 's/.*\///g'
    done
}

#
# Main function.
#
exec $(cleanName | dmenu)
